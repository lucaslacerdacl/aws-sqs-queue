language: node_js
node_js:
  - 14

branches:
  only:
    - main

before_script:
  - yarn

script:
 - yarn lint
 - yarn test-coverage-upload
 - yarn compile
 - yarn docs

jobs:
  include:
    - stage: NPM Publish
      deploy:
        provider: npm
        email: $NPM_EMAIL
        api_key: $NPM_TOKEN
        on:
          branch: main
    - stage: GitHub Release
      deploy:
        provider: pages
        local_dir: docs/
        github_token: $GITHUB_TOKEN
        skip_cleanup: true
        on:
          branch: main